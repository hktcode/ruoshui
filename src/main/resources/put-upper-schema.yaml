$schema: http://json-schema.org/draft-04/schema#
type: object
properties:
  consumer:
    type: object
    properties:
      src_property:
        type: object
        properties:
          PGDBNAME:
            oneOf: [{"type": "string"}, {"type": "number"}]
            default: "postgres"
          PGHOST:
            oneOf: [{"type": "string"}, {"type": "number"}]
            default: "localhost"
          PGPORT:
            oneOf: [{"type": "string"}, {"type": "number"}]
            default: 5432
          user:
            oneOf: [{"type": "string"}, {"type": "number"}]
            default: "postgres"
          password:
            oneOf: [{"type": "string"}, {"type": "number"}]
        patternProperties:
          "^.*$": { "oneOf": [{ "type":"string"}, {"type":"number"}] }
      typelist_sql: { "type": "string" } # TODO: default
      tuple_select:
        type: object
        # propertyNames: { pattern: "(?:(?:[^.]|(?:\\.\\.))+)(?:\\.)(?:(?:[^.]|(?:\\.\\.))+)" }
        patternProperties: { "^.*$": { "type": "string" } }
        default: {}
      relation_sql: { "type": "string" } # TODO: default
      logical_repl:
        type: object
        properties:
          slot_name: { type: string, default: ruoshui, pattern: "[0-9a-z_]{1,63}" }
          status_interval: { type: integer, minimum: 1, maximum: 2147483647, default: 10000 }
          start_position: { type: "string", default: "0/0", pattern: "[0-9A-Fa-f]{1,8}/[0-9A-Fa-f]{1,8}" }
          publication_names:
            type: array
            items: { type: "string", pattern: "[0-9a-z_]{1,63}" }
            default: ["ruoshui"]
      get_snapshot: { type: boolean, default: true }
      standby_skip: { type: boolean, default: true }
      where_script:
        oneOf:
          - type: string
          - type: object
            properties:
              engine_name: { type: string } # TODO:
              script_text: { type: string }
      locking_mode:
        type: string
        enum:
          - "NO_LOCK"
          - "ACCESS_SHARE"
          - "ROW_SHARE"
          - "ROW_EXCLUSIVE"
          - "SHARE_UPDATE_EXCLUSIVE"
          - "SHARE"
          - "SHARE_ROW_EXCLUSIVE"
          - "EXCLUSIVE"
          - "ACCESS_EXCLUSIVE"
        default: "SHARE_UPDATE_EXCLUSIVE"
      rs_fetchsize: { type: integer, default: 10240, minimum: 0, maximum: 2147483647 }
      wait_timeout: { type: integer, default: 100, minimum: 10, maximum: 9223372036854775807 }
      log_duration: { type: integer, default: 30000, minimum: 0, maximum: 9223372036854775807 }
  junction:
    type: object
    properties:
      comein_count: { type: integer, default: 100, minimum: 1, maximum: 2147483647 }
      getout_count: { type: integer, default: 100, minimum: 1, maximum: 2147483647 }
      wait_timeout: { type: integer, default: 100, minimum: 10, maximum: 9223372036854775807 }
      log_duration: { type: integer, default: 30000, minimum: 0, maximum: 9223372036854775807 }
  producer:
    type: object
    properties:
      kfk_property:
        type: object
        properties:
          bootstrap.servers: { type: string, default: "localhost:9092" }
        patternProperties: { "^.*$": { "type": "string" } }
      target_topic: { type: string, "default": "ruoshui-upper" } #TODO: parttern
      partition_no: { type: integer, default: 0, minimum: 0, maximum: 2147483647 }
      wait_timeout: { type: integer, default: 100, minimum: 10, maximum: 9223372036854775807 }
      log_duration: { type: integer, default: 30000, minimum: 0, maximum: 9223372036854775807 }
